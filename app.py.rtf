{\rtf1\ansi\ansicpg1251\cocoartf2513
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\froman\fcharset0 Times-Roman;\f1\fnil\fcharset0 AppleColorEmoji;}
{\colortbl;\red255\green255\blue255;\red0\green0\blue0;}
{\*\expandedcolortbl;;\cssrgb\c0\c0\c0;}
\paperw11900\paperh16840\margl1440\margr1440\vieww10800\viewh8400\viewkind0
\deftab720
\pard\pardeftab720\partightenfactor0

\f0\fs24 \cf2 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 # Patrick \'97 Telegram bot for English practice (Render-ready version)\
\
import os\
import logging\
from telegram import Update, ReplyKeyboardMarkup\
from telegram.ext import ApplicationBuilder, ContextTypes, CommandHandler, MessageHandler, filters\
import openai\
\
# Logging\
logging.basicConfig(\
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',\
    level=logging.INFO\
)\
\
# OpenAI key\
openai.api_key = os.getenv("OPENAI_API_KEY")\
\
# Greetings and options\
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):\
    user_first = update.effective_user.first_name\
    reply_keyboard = [["\uc0\u1055 \u1077 \u1088 \u1077 \u1082 \u1083 \u1072 \u1076 ", "\u1054 \u1073 \u1075 \u1086 \u1074 \u1086 \u1088 \u1080 \u1090 \u1080  \u1085 \u1086 \u1074 \u1080 \u1085 \u1080 ", "\u1055 \u1086 \u1076 \u1080 \u1089 \u1082 \u1091 \u1090 \u1080 \u1074 \u1072 \u1090 \u1080 "]]\
    markup = ReplyKeyboardMarkup(reply_keyboard, one_time_keyboard=True, resize_keyboard=True)\
    await update.message.reply_text(f"\uc0\u1055 \u1088 \u1080 \u1074 \u1110 \u1090 , \{user_first\}! 
\f1 \uc0\u55357 \u56395 
\f0 \\n\\n\uc0\u1065 \u1086  \u1088 \u1086 \u1073 \u1080 \u1084 \u1086  \u1089 \u1100 \u1086 \u1075 \u1086 \u1076 \u1085 \u1110 ?", reply_markup=markup)\
\
# Main logic: reply with OpenAI\
async def reply(update: Update, context: ContextTypes.DEFAULT_TYPE):\
    user_input = update.message.text\
\
    # Compose context prompt for OpenAI\
    messages = [\
        \{"role": "system", "content": "Patrick \'97 \uc0\u1076 \u1086 \u1073 \u1088 \u1086 \u1079 \u1080 \u1095 \u1083 \u1080 \u1074 \u1080 \u1081  \u1072 \u1089 \u1080 \u1089 \u1090 \u1077 \u1085 \u1090 , \u1089 \u1090 \u1074 \u1086 \u1088 \u1077 \u1085 \u1080 \u1081  \u1050 \u1086 \u1089 \u1090 \u1077 \u1102  \u1076 \u1083 \u1103  \u1087 \u1088 \u1072 \u1082 \u1090 \u1080 \u1082 \u1080  \u1072 \u1085 \u1075 \u1083 \u1110 \u1081 \u1089 \u1100 \u1082 \u1086 \u1111  \u1084 \u1086 \u1074 \u1080 .\\n\\n
\f1 \uc0\u55357 \u56632 
\f0  \uc0\u1057 \u1087 \u1110 \u1083 \u1082 \u1091 \u1081 \u1089 \u1103  \u1091 \u1082 \u1088 \u1072 \u1111 \u1085 \u1089 \u1100 \u1082 \u1086 \u1102 , \u1079 \u1074 \u1077 \u1088 \u1090 \u1072 \u1081 \u1089 \u1103  \u1076 \u1086  \u1089 \u1090 \u1091 \u1076 \u1077 \u1085 \u1090 \u1072  \u1085 \u1072  '\u1090 \u1080 '. \u1041 \u1091 \u1076 \u1100  \u1091 \u1074 \u1072 \u1078 \u1085 \u1080 \u1084 , \u1087 \u1110 \u1076 \u1090 \u1088 \u1080 \u1084 \u1091 \u1081 , \u1078 \u1072 \u1088 \u1090 \u1091 \u1081  \u1076 \u1077 \u1083 \u1110 \u1082 \u1072 \u1090 \u1085 \u1086 .\\n
\f1 \uc0\u55357 \u56632 
\f0  \uc0\u1071 \u1082 \u1097 \u1086  \u1089 \u1090 \u1091 \u1076 \u1077 \u1085 \u1090  \u1088 \u1086 \u1073 \u1080 \u1090 \u1100  \u1087 \u1086 \u1084 \u1080 \u1083 \u1082 \u1091 : \u1079 \u1072 \u1087 \u1088 \u1086 \u1087 \u1086 \u1085 \u1091 \u1081  \u1079 \u1085 \u1072 \u1081 \u1090 \u1080  \u1111 \u1111  \u1089 \u1072 \u1084 \u1086 \u1089 \u1090 \u1110 \u1081 \u1085 \u1086  (
\f1 \uc0\u55357 \u56384 
\f0 ), \uc0\u1087 \u1086 \u1082 \u1072 \u1078 \u1080  \u1076 \u1077  \u1087 \u1086 \u1084 \u1080 \u1083 \u1082 \u1072  (
\f1 \uc0\u10145 \u65039 
\f0 ), \uc0\u1087 \u1088 \u1072 \u1074 \u1080 \u1083 \u1100 \u1085 \u1080 \u1081  \u1074 \u1072 \u1088 \u1110 \u1072 \u1085 \u1090  (
\f1 \uc0\u9989 
\f0 ), \uc0\u1087 \u1086 \u1103 \u1089 \u1085 \u1077 \u1085 \u1085 \u1103  (
\f1 \uc0\u55357 \u56538 
\f0 ).\\n
\f1 \uc0\u55357 \u56632 
\f0  \uc0\u1071 \u1082 \u1097 \u1086  \u1089 \u1090 \u1091 \u1076 \u1077 \u1085 \u1090  \u1091 \u1085 \u1080 \u1082 \u1072 \u1108  \u1074 \u1080 \u1082 \u1086 \u1088 \u1080 \u1089 \u1090 \u1072 \u1085 \u1085 \u1103  \u1085 \u1086 \u1074 \u1080 \u1093  \u1089 \u1083 \u1110 \u1074  \'97 \u1084 \u700 \u1103 \u1082 \u1086  \u1087 \u1110 \u1076 \u1082 \u1072 \u1079 \u1091 \u1081 , \u1103 \u1082  \u1074 \u1089 \u1090 \u1072 \u1074 \u1080 \u1090 \u1080 .\\n
\f1 \uc0\u55357 \u56633 
\f0  \uc0\u1050 \u1086 \u1078 \u1085 \u1077  \u1079 \u1072 \u1085 \u1103 \u1090 \u1090 \u1103  \u1087 \u1086 \u1095 \u1080 \u1085 \u1072 \u1108 \u1090 \u1100 \u1089 \u1103  \u1079  '\u1065 \u1086  \u1088 \u1086 \u1073 \u1080 \u1084 \u1086  \u1089 \u1100 \u1086 \u1075 \u1086 \u1076 \u1085 \u1110 ?' \u1110  \u1090 \u1088 \u1100 \u1086 \u1084 \u1072  \u1074 \u1072 \u1088 \u1110 \u1072 \u1085 \u1090 \u1072 \u1084 \u1080 .\\n
\f1 \uc0\u55357 \u56632 
\f0  \uc0\u1059  \u1092 \u1086 \u1088 \u1084 \u1072 \u1090 \u1072 \u1093  \u1055 \u1077 \u1088 \u1077 \u1082 \u1083 \u1072 \u1076 , \u1054 \u1073 \u1075 \u1086 \u1074 \u1086 \u1088 \u1080 \u1090 \u1080  \u1085 \u1086 \u1074 \u1080 \u1085 \u1080 , \u1055 \u1086 \u1076 \u1080 \u1089 \u1082 \u1091 \u1090 \u1080 \u1074 \u1072 \u1090 \u1080  \'97 \u1076 \u1086 \u1090 \u1088 \u1080 \u1084 \u1091 \u1081 \u1089 \u1103  \u1089 \u1087 \u1077 \u1094 \u1110 \u1072 \u1083 \u1100 \u1085 \u1086 \u1111  \u1083 \u1086 \u1075 \u1110 \u1082 \u1080 , \u1087 \u1086 \u1103 \u1089 \u1085 \u1077 \u1085 \u1100 , \u1074 \u1080 \u1087 \u1088 \u1072 \u1074 \u1083 \u1077 \u1085 \u1100 .\\n
\f1 \uc0\u55357 \u56577 
\f0  \uc0\u1059  \u1074 \u1089 \u1110 \u1093  \u1092 \u1086 \u1088 \u1084 \u1072 \u1090 \u1072 \u1093  \u1074 \u1080 \u1082 \u1086 \u1088 \u1080 \u1089 \u1090 \u1086 \u1074 \u1091 \u1108 \u1090 \u1100 \u1089 \u1103  \u1083 \u1077 \u1082 \u1089 \u1080 \u1082 \u1072  \u1075 \u1088 \u1091 \u1087 \u1080  \u1089 \u1090 \u1091 \u1076 \u1077 \u1085 \u1090 \u1072  (\u1079 \u1073 \u1077 \u1088 \u1110 \u1075 \u1072 \u1108 \u1090 \u1100 \u1089 \u1103  \u1086 \u1082 \u1088 \u1077 \u1084 \u1086 ).\\n
\f1 \uc0\u55357 \u56524 
\f0  \uc0\u1047 \u1072 \u1074 \u1078 \u1076 \u1080  \u1087 \u1110 \u1076 \u1090 \u1088 \u1080 \u1084 \u1091 \u1081  \u1076 \u1110 \u1072 \u1083 \u1086 \u1075 .\\n
\f1 \uc0\u55357 \u56538 
\f0  \uc0\u1050 \u1086 \u1083 \u1080  \u1089 \u1090 \u1091 \u1076 \u1077 \u1085 \u1090  \u1085 \u1077  \u1088 \u1086 \u1079 \u1091 \u1084 \u1110 \u1108  \u1089 \u1083 \u1086 \u1074 \u1086  \'97 \u1087 \u1086 \u1103 \u1089 \u1085 \u1080  \u1091 \u1082 \u1088 \u1072 \u1111 \u1085 \u1089 \u1100 \u1082 \u1086 \u1102  \u1079  \u1087 \u1088 \u1080 \u1082 \u1083 \u1072 \u1076 \u1086 \u1084 .\\n
\f1 \uc0\u9940 
\f0  \uc0\u1053 \u1077  \u1076 \u1072 \u1074 \u1072 \u1081  \u1087 \u1077 \u1088 \u1077 \u1082 \u1083 \u1072 \u1076  \u1086 \u1076 \u1088 \u1072 \u1079 \u1091 .\\n
\f1 \uc0\u55356 \u57263 
\f0  \uc0\u1062 \u1110 \u1083 \u1100  \'97 \u1087 \u1110 \u1076 \u1090 \u1088 \u1080 \u1084 \u1072 \u1090 \u1080  \u1084 \u1080 \u1089 \u1083 \u1077 \u1085 \u1085 \u1103  \u1110  \u1089 \u1090 \u1080 \u1084 \u1091 \u1083 \u1102 \u1074 \u1072 \u1090 \u1080  \u1087 \u1088 \u1080 \u1088 \u1086 \u1076 \u1085 \u1091  \u1088 \u1086 \u1079 \u1084 \u1086 \u1074 \u1091 .\\n"\},\
        \{"role": "user", "content": user_input\},\
    ]\
\
    try:\
        response = openai.ChatCompletion.create(\
            model="gpt-4o",\
            messages=messages,\
            temperature=0.7\
        )\
        reply_text = response.choices[0].message["content"]\
        await update.message.reply_text(reply_text)\
    except Exception as e:\
        logging.error(f"OpenAI error: \{e\}")\
        await update.message.reply_text("\uc0\u1042 \u1080 \u1073 \u1072 \u1095 , \u1089 \u1090 \u1072 \u1083 \u1072 \u1089 \u1103  \u1087 \u1086 \u1084 \u1080 \u1083 \u1082 \u1072 . \u1057 \u1087 \u1088 \u1086 \u1073 \u1091 \u1081  \u1097 \u1077  \u1088 \u1072 \u1079  \u1090 \u1088 \u1086 \u1093 \u1080  \u1087 \u1110 \u1079 \u1085 \u1110 \u1096 \u1077  
\f1 \uc0\u55357 \u56911 
\f0 ")\
\
# Token and run\
if __name__ == '__main__':\
    application = ApplicationBuilder().token(os.getenv("TELEGRAM_TOKEN")).build()\
    application.add_handler(CommandHandler("start", start))\
    application.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, reply))\
    application.run_polling()\
}